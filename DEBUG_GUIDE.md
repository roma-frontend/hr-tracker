# üêõ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—Ç–ª–∞–¥–∫–µ - HR Office

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–Ω–æ–ø–∫–∏ "Approve" –∏ "Reject" –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- –û—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000/approvals
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥: `"Approvals page - Current user: ..."`

**–ï—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `null` –∏–ª–∏ `undefined`:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ store
- –ù—É–∂–Ω–æ –≤–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
localStorage.clear()
// –ó–∞—Ç–µ–º –≤–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
```

---

### 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Navbar

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í Navbar –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "U" –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏
- –ù–µ—Ç –∞–≤–∞—Ç–∞—Ä–∞

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `"Navbar - Current user: ..."`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ localStorage:
```javascript
JSON.parse(localStorage.getItem('hr-auth-storage'))
```

**–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—Å—Ç—å –≤ localStorage, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:**
```javascript
// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
window.location.reload()
```

**–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –≤ localStorage:**
- –í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ /login

---

### 3. Cloudinary - –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- "Unknown API key"
- "Invalid upload preset"

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

–í `.env.local` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```env
NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=dsfbt0q1y
NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET=ml_default
```

**–®–∞–≥–∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Cloud Name:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ https://cloudinary.com/console
   - –í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É - –≤–∞—à cloud name
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å `dsfbt0q1y`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Upload Preset:**
   - Settings ‚Üí Upload ‚Üí Upload presets
   - –ù–∞–π–¥–∏—Ç–µ preset —Å –∏–º–µ–Ω–µ–º `ml_default`
   - –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ:
     - Name: `ml_default`
     - Signing mode: **Unsigned**
     - Folder: `hr-office/avatars`

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ (Ctrl+C)
# –ó–∞—Ç–µ–º
npm run dev
```

---

### 4. –°–µ—Å—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω—É–∂–Ω–æ –≤—Ö–æ–¥–∏—Ç—å –∑–∞–Ω–æ–≤–æ
- Cookies –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ cookies:**
```javascript
document.cookie
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- `hr-auth-token=...`
- `hr-session-token=...`

2. **–ï—Å–ª–∏ cookies –Ω–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ `localhost:3000`
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `127.0.0.1` –∏–ª–∏ –¥—Ä—É–≥–∏–µ –∞–¥—Ä–µ—Å–∞

---

## üß™ –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ store
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
const storage = localStorage.getItem('hr-auth-storage');
console.log('Storage:', JSON.parse(storage));
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "state": {
    "user": {
      "id": "...",
      "name": "...",
      "email": "...",
      "role": "admin"
    },
    "isAuthenticated": true
  }
}
```

---

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
fetch('/api/session')
  .then(r => r.json())
  .then(console.log);
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
–û–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### –¢–µ—Å—Ç 3: –û–¥–æ–±—Ä–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—Ä—É—á–Ω—É—é
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ Convex Dashboard (https://dashboard.convex.dev)
// Functions ‚Üí migrations:approveAllExistingUsers ‚Üí Run
{}
```

---

## üîß –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã (Ctrl+C –≤ –æ–±–æ–∏—Ö –æ–∫–Ω–∞—Ö)

# 2. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
# –í –±—Ä–∞—É–∑–µ—Ä–µ: Ctrl+Shift+Delete ‚Üí –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ

# 3. –û—á–∏—Å—Ç–∏—Ç–µ localStorage
# –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
localStorage.clear()

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã
npx convex dev
# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
npm run dev

# 5. –í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
# http://localhost:3000/login
```

---

## üìä –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ —Å–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] –°–µ—Ä–≤–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã (Convex + Next.js)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
- [ ] localStorage —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] Cookies —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] .env.local —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- [ ] Cloudinary preset —Å–æ–∑–¥–∞–Ω –∫–∞–∫ unsigned
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–¥–æ–±—Ä–µ–Ω (isApproved: true)

---

## üÜò –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

### "Please login again"
- **–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ store
- **–†–µ—à–µ–Ω–∏–µ:** `localStorage.clear()` ‚Üí –í–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ

### "Only admins can approve users"
- **–ü—Ä–∏—á–∏–Ω–∞:** –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ admin
- **–†–µ—à–µ–Ω–∏–µ:** –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ `romangulanyan@gmail.com`

### "User not found"
- **–ü—Ä–∏—á–∏–Ω–∞:** ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–≤–µ—Ä–Ω—ã–π
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `user.id` –≤ –∫–æ–Ω—Å–æ–ª–∏

### "Your account is pending admin approval"
- **–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –æ–¥–æ–±—Ä–µ–Ω
- **–†–µ—à–µ–Ω–∏–µ:** –û–¥–æ–±—Ä–∏—Ç–µ —á–µ—Ä–µ–∑ `/api/approve-all` –∏–ª–∏ `/approvals`

---

**–î–∞—Ç–∞:** 2026-02-23  
**–í–µ—Ä—Å–∏—è:** 3.1
